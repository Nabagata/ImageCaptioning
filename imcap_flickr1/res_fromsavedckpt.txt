Namespace(batch_size=128, caption_path='../data/flickr/results_train1.json', crop_size=224, embed_size=256, hidden_size=512, image_dir='../data/flickr/resized', learning_rate=0.001, log_step=10, model_path='models/', num_epochs=5, num_layers=1, num_workers=2, save_step=340, vocab_path='../data/flickr/vocab.pkl')
loading annotations into memory...
Done (t=0.05s)
creating index...
index created!
Epoch [0/5], Step [0/340], Loss: 7.1903, Perplexity: 1326.5327
Epoch [0/5], Step [10/340], Loss: 4.3105, Perplexity: 74.4787
Epoch [0/5], Step [20/340], Loss: 3.8571, Perplexity: 47.3298
Epoch [0/5], Step [30/340], Loss: 3.8078, Perplexity: 45.0519
Epoch [0/5], Step [40/340], Loss: 3.6789, Perplexity: 39.6028
Epoch [0/5], Step [50/340], Loss: 3.4416, Perplexity: 31.2381
Epoch [0/5], Step [60/340], Loss: 3.3811, Perplexity: 29.4023
Epoch [0/5], Step [70/340], Loss: 3.2593, Perplexity: 26.0310
Epoch [0/5], Step [80/340], Loss: 3.2648, Perplexity: 26.1745
Epoch [0/5], Step [90/340], Loss: 3.1582, Perplexity: 23.5273
Epoch [0/5], Step [100/340], Loss: 3.2152, Perplexity: 24.9075
Epoch [0/5], Step [110/340], Loss: 3.0739, Perplexity: 21.6250
Epoch [0/5], Step [120/340], Loss: 3.1491, Perplexity: 23.3161
Epoch [0/5], Step [130/340], Loss: 2.9931, Perplexity: 19.9484
Epoch [0/5], Step [140/340], Loss: 2.9568, Perplexity: 19.2365
Epoch [0/5], Step [150/340], Loss: 3.0093, Perplexity: 20.2741
Epoch [0/5], Step [160/340], Loss: 2.9398, Perplexity: 18.9121
Epoch [0/5], Step [170/340], Loss: 3.0305, Perplexity: 20.7074
Epoch [0/5], Step [180/340], Loss: 2.9651, Perplexity: 19.3971
Epoch [0/5], Step [190/340], Loss: 2.8531, Perplexity: 17.3411
Epoch [0/5], Step [200/340], Loss: 2.9515, Perplexity: 19.1345
Epoch [0/5], Step [210/340], Loss: 2.8703, Perplexity: 17.6427
Epoch [0/5], Step [220/340], Loss: 2.8884, Perplexity: 17.9641
Epoch [0/5], Step [230/340], Loss: 2.8602, Perplexity: 17.4655
Epoch [0/5], Step [240/340], Loss: 2.8672, Perplexity: 17.5872
Epoch [0/5], Step [250/340], Loss: 2.7378, Perplexity: 15.4530
Epoch [0/5], Step [260/340], Loss: 2.9468, Perplexity: 19.0456
Epoch [0/5], Step [270/340], Loss: 2.8486, Perplexity: 17.2643
Epoch [0/5], Step [280/340], Loss: 2.7938, Perplexity: 16.3431
Epoch [0/5], Step [290/340], Loss: 2.7495, Perplexity: 15.6341
Epoch [0/5], Step [300/340], Loss: 2.6703, Perplexity: 14.4437
Epoch [0/5], Step [310/340], Loss: 2.8073, Perplexity: 16.5650
Epoch [0/5], Step [320/340], Loss: 2.8113, Perplexity: 16.6320
Epoch [0/5], Step [330/340], Loss: 2.7821, Perplexity: 16.1531
Epoch [1/5], Step [0/340], Loss: 2.8445, Perplexity: 17.1930
Epoch [1/5], Step [10/340], Loss: 2.6824, Perplexity: 14.6203
Epoch [1/5], Step [20/340], Loss: 2.7223, Perplexity: 15.2146
Epoch [1/5], Step [30/340], Loss: 2.7419, Perplexity: 15.5164
Epoch [1/5], Step [40/340], Loss: 2.6818, Perplexity: 14.6111
Epoch [1/5], Step [50/340], Loss: 2.7997, Perplexity: 16.4394
Epoch [1/5], Step [60/340], Loss: 2.5959, Perplexity: 13.4086
Epoch [1/5], Step [70/340], Loss: 2.7062, Perplexity: 14.9726
Epoch [1/5], Step [80/340], Loss: 2.7726, Perplexity: 15.9995
Epoch [1/5], Step [90/340], Loss: 2.6706, Perplexity: 14.4494
Epoch [1/5], Step [100/340], Loss: 2.6661, Perplexity: 14.3838
Epoch [1/5], Step [110/340], Loss: 2.7519, Perplexity: 15.6727
Epoch [1/5], Step [120/340], Loss: 2.6592, Perplexity: 14.2842
Epoch [1/5], Step [130/340], Loss: 2.6309, Perplexity: 13.8860
Epoch [1/5], Step [140/340], Loss: 2.5521, Perplexity: 12.8346
Epoch [1/5], Step [150/340], Loss: 2.6388, Perplexity: 13.9969
Epoch [1/5], Step [160/340], Loss: 2.6461, Perplexity: 14.0990
Epoch [1/5], Step [170/340], Loss: 2.6330, Perplexity: 13.9160
Epoch [1/5], Step [180/340], Loss: 2.6032, Perplexity: 13.5074
Epoch [1/5], Step [190/340], Loss: 2.5991, Perplexity: 13.4521
Epoch [1/5], Step [200/340], Loss: 2.5017, Perplexity: 12.2035
Epoch [1/5], Step [210/340], Loss: 2.5693, Perplexity: 13.0573
Epoch [1/5], Step [220/340], Loss: 2.5954, Perplexity: 13.4025
Epoch [1/5], Step [230/340], Loss: 2.5338, Perplexity: 12.6012
Epoch [1/5], Step [240/340], Loss: 2.5971, Perplexity: 13.4254
Epoch [1/5], Step [250/340], Loss: 2.5750, Perplexity: 13.1312
Epoch [1/5], Step [260/340], Loss: 2.5152, Perplexity: 12.3697
Epoch [1/5], Step [270/340], Loss: 2.4790, Perplexity: 11.9288
Epoch [1/5], Step [280/340], Loss: 2.6126, Perplexity: 13.6344
Epoch [1/5], Step [290/340], Loss: 2.4739, Perplexity: 11.8686
Epoch [1/5], Step [300/340], Loss: 2.4848, Perplexity: 11.9984
Epoch [1/5], Step [310/340], Loss: 2.6315, Perplexity: 13.8950
Epoch [1/5], Step [320/340], Loss: 2.5111, Perplexity: 12.3187
Epoch [1/5], Step [330/340], Loss: 2.5713, Perplexity: 13.0828
Epoch [2/5], Step [0/340], Loss: 2.5245, Perplexity: 12.4850
Epoch [2/5], Step [10/340], Loss: 2.5105, Perplexity: 12.3108
Epoch [2/5], Step [20/340], Loss: 2.4238, Perplexity: 11.2887
Epoch [2/5], Step [30/340], Loss: 2.5081, Perplexity: 12.2811
Epoch [2/5], Step [40/340], Loss: 2.4133, Perplexity: 11.1710
Epoch [2/5], Step [50/340], Loss: 2.5180, Perplexity: 12.4042
Epoch [2/5], Step [60/340], Loss: 2.4849, Perplexity: 12.0003
Epoch [2/5], Step [70/340], Loss: 2.4505, Perplexity: 11.5946
Epoch [2/5], Step [80/340], Loss: 2.4420, Perplexity: 11.4960
Epoch [2/5], Step [90/340], Loss: 2.4761, Perplexity: 11.8944
Epoch [2/5], Step [100/340], Loss: 2.5002, Perplexity: 12.1851
Epoch [2/5], Step [110/340], Loss: 2.5424, Perplexity: 12.7096
Epoch [2/5], Step [120/340], Loss: 2.4773, Perplexity: 11.9088
Epoch [2/5], Step [130/340], Loss: 2.5124, Perplexity: 12.3340
Epoch [2/5], Step [140/340], Loss: 2.4739, Perplexity: 11.8687
Epoch [2/5], Step [150/340], Loss: 2.4657, Perplexity: 11.7712
Epoch [2/5], Step [160/340], Loss: 2.4934, Perplexity: 12.1018
Epoch [2/5], Step [170/340], Loss: 2.4249, Perplexity: 11.3009
Epoch [2/5], Step [180/340], Loss: 2.4627, Perplexity: 11.7370
Epoch [2/5], Step [190/340], Loss: 2.4187, Perplexity: 11.2314
Epoch [2/5], Step [200/340], Loss: 2.5820, Perplexity: 13.2230
Epoch [2/5], Step [210/340], Loss: 2.3874, Perplexity: 10.8855
Epoch [2/5], Step [220/340], Loss: 2.4572, Perplexity: 11.6716
Epoch [2/5], Step [230/340], Loss: 2.4285, Perplexity: 11.3423
Epoch [2/5], Step [240/340], Loss: 2.5108, Perplexity: 12.3153
Epoch [2/5], Step [250/340], Loss: 2.5669, Perplexity: 13.0250
Epoch [2/5], Step [260/340], Loss: 2.4558, Perplexity: 11.6557
Epoch [2/5], Step [270/340], Loss: 2.4320, Perplexity: 11.3811
Epoch [2/5], Step [280/340], Loss: 2.5055, Perplexity: 12.2498
Epoch [2/5], Step [290/340], Loss: 2.3166, Perplexity: 10.1414
Epoch [2/5], Step [300/340], Loss: 2.4522, Perplexity: 11.6139
Epoch [2/5], Step [310/340], Loss: 2.4624, Perplexity: 11.7324
Epoch [2/5], Step [320/340], Loss: 2.5225, Perplexity: 12.4591
Epoch [2/5], Step [330/340], Loss: 2.4475, Perplexity: 11.5594
Epoch [3/5], Step [0/340], Loss: 2.4343, Perplexity: 11.4082
Epoch [3/5], Step [10/340], Loss: 2.4107, Perplexity: 11.1418
Epoch [3/5], Step [20/340], Loss: 2.3380, Perplexity: 10.3602
Epoch [3/5], Step [30/340], Loss: 2.3960, Perplexity: 10.9792
Epoch [3/5], Step [40/340], Loss: 2.4215, Perplexity: 11.2626
Epoch [3/5], Step [50/340], Loss: 2.4054, Perplexity: 11.0832
Epoch [3/5], Step [60/340], Loss: 2.4479, Perplexity: 11.5646
Epoch [3/5], Step [70/340], Loss: 2.3788, Perplexity: 10.7922
Epoch [3/5], Step [80/340], Loss: 2.3388, Perplexity: 10.3687
Epoch [3/5], Step [90/340], Loss: 2.3918, Perplexity: 10.9326
Epoch [3/5], Step [100/340], Loss: 2.2953, Perplexity: 9.9278
Epoch [3/5], Step [110/340], Loss: 2.3308, Perplexity: 10.2866
Epoch [3/5], Step [120/340], Loss: 2.4708, Perplexity: 11.8317
Epoch [3/5], Step [130/340], Loss: 2.3463, Perplexity: 10.4465
Epoch [3/5], Step [140/340], Loss: 2.2877, Perplexity: 9.8521
Epoch [3/5], Step [150/340], Loss: 2.3659, Perplexity: 10.6532
Epoch [3/5], Step [160/340], Loss: 2.4147, Perplexity: 11.1869
Epoch [3/5], Step [170/340], Loss: 2.3854, Perplexity: 10.8636
Epoch [3/5], Step [180/340], Loss: 2.4197, Perplexity: 11.2424
Epoch [3/5], Step [190/340], Loss: 2.3548, Perplexity: 10.5361
Epoch [3/5], Step [200/340], Loss: 2.3700, Perplexity: 10.6973
Epoch [3/5], Step [210/340], Loss: 2.3925, Perplexity: 10.9404
Epoch [3/5], Step [220/340], Loss: 2.3966, Perplexity: 10.9863
Epoch [3/5], Step [230/340], Loss: 2.2971, Perplexity: 9.9457
Epoch [3/5], Step [240/340], Loss: 2.2762, Perplexity: 9.7399
Epoch [3/5], Step [250/340], Loss: 2.3577, Perplexity: 10.5670
Epoch [3/5], Step [260/340], Loss: 2.3540, Perplexity: 10.5278
Epoch [3/5], Step [270/340], Loss: 2.3322, Perplexity: 10.3001
Epoch [3/5], Step [280/340], Loss: 2.3108, Perplexity: 10.0821
Epoch [3/5], Step [290/340], Loss: 2.2205, Perplexity: 9.2121
Epoch [3/5], Step [300/340], Loss: 2.3917, Perplexity: 10.9321
Epoch [3/5], Step [310/340], Loss: 2.3273, Perplexity: 10.2505
Epoch [3/5], Step [320/340], Loss: 2.2302, Perplexity: 9.3015
Epoch [3/5], Step [330/340], Loss: 2.3478, Perplexity: 10.4620
Epoch [4/5], Step [0/340], Loss: 2.2145, Perplexity: 9.1571
Epoch [4/5], Step [10/340], Loss: 2.2834, Perplexity: 9.8096
Epoch [4/5], Step [20/340], Loss: 2.2725, Perplexity: 9.7037
Epoch [4/5], Step [30/340], Loss: 2.2438, Perplexity: 9.4288
Epoch [4/5], Step [40/340], Loss: 2.2713, Perplexity: 9.6917
Epoch [4/5], Step [50/340], Loss: 2.2330, Perplexity: 9.3276
Epoch [4/5], Step [60/340], Loss: 2.2831, Perplexity: 9.8066
Epoch [4/5], Step [70/340], Loss: 2.2052, Perplexity: 9.0719
Epoch [4/5], Step [80/340], Loss: 2.2714, Perplexity: 9.6928
Epoch [4/5], Step [90/340], Loss: 2.2050, Perplexity: 9.0705
Epoch [4/5], Step [100/340], Loss: 2.2869, Perplexity: 9.8440
Epoch [4/5], Step [110/340], Loss: 2.2883, Perplexity: 9.8583
Epoch [4/5], Step [120/340], Loss: 2.2485, Perplexity: 9.4731
Epoch [4/5], Step [130/340], Loss: 2.2309, Perplexity: 9.3081
Epoch [4/5], Step [140/340], Loss: 2.2153, Perplexity: 9.1644
Epoch [4/5], Step [150/340], Loss: 2.2646, Perplexity: 9.6277
Epoch [4/5], Step [160/340], Loss: 2.3534, Perplexity: 10.5217
Epoch [4/5], Step [170/340], Loss: 2.3707, Perplexity: 10.7053
Epoch [4/5], Step [180/340], Loss: 2.2257, Perplexity: 9.2599
Epoch [4/5], Step [190/340], Loss: 2.2003, Perplexity: 9.0279
Epoch [4/5], Step [200/340], Loss: 2.3245, Perplexity: 10.2211
Epoch [4/5], Step [210/340], Loss: 2.2791, Perplexity: 9.7684
Epoch [4/5], Step [220/340], Loss: 2.2651, Perplexity: 9.6318
Epoch [4/5], Step [230/340], Loss: 2.2362, Perplexity: 9.3582
Epoch [4/5], Step [240/340], Loss: 2.2803, Perplexity: 9.7796
Epoch [4/5], Step [250/340], Loss: 2.2627, Perplexity: 9.6087
Epoch [4/5], Step [260/340], Loss: 2.3485, Perplexity: 10.4698
Epoch [4/5], Step [270/340], Loss: 2.2666, Perplexity: 9.6470
Epoch [4/5], Step [280/340], Loss: 2.3026, Perplexity: 10.0005
Epoch [4/5], Step [290/340], Loss: 2.2955, Perplexity: 9.9294
Epoch [4/5], Step [300/340], Loss: 2.2923, Perplexity: 9.8974
Epoch [4/5], Step [310/340], Loss: 2.2468, Perplexity: 9.4572
Epoch [4/5], Step [320/340], Loss: 2.3466, Perplexity: 10.4501
Epoch [4/5], Step [330/340], Loss: 2.2348, Perplexity: 9.3448
