Namespace(batch_size=128, caption_path='../data/flickr/results_train1.json', crop_size=224, embed_size=256, hidden_size=512, image_dir='../data/flickr/resized', learning_rate=0.001, log_step=10, model_path='models/', num_epochs=5, num_layers=1, num_workers=2, save_step=1000, vocab_path='../data/flickr/vocab1.pkl')
loading annotations into memory...
Done (t=0.05s)
creating index...
index created!
Epoch [0/5], Step [0/340], Loss: 8.4512, Perplexity: 4680.5724
Epoch [0/5], Step [10/340], Loss: 5.4795, Perplexity: 239.7333
Epoch [0/5], Step [20/340], Loss: 5.0514, Perplexity: 156.2350
Epoch [0/5], Step [30/340], Loss: 4.7946, Perplexity: 120.8598
Epoch [0/5], Step [40/340], Loss: 4.4782, Perplexity: 88.0717
Epoch [0/5], Step [50/340], Loss: 4.2814, Perplexity: 72.3403
Epoch [0/5], Step [60/340], Loss: 4.2370, Perplexity: 69.2008
Epoch [0/5], Step [70/340], Loss: 3.8113, Perplexity: 45.2072
Epoch [0/5], Step [80/340], Loss: 3.8684, Perplexity: 47.8674
Epoch [0/5], Step [90/340], Loss: 3.8827, Perplexity: 48.5565
Epoch [0/5], Step [100/340], Loss: 3.8036, Perplexity: 44.8612
Epoch [0/5], Step [110/340], Loss: 3.6339, Perplexity: 37.8599
Epoch [0/5], Step [120/340], Loss: 3.6174, Perplexity: 37.2407
Epoch [0/5], Step [130/340], Loss: 3.4710, Perplexity: 32.1684
Epoch [0/5], Step [140/340], Loss: 3.4734, Perplexity: 32.2457
Epoch [0/5], Step [150/340], Loss: 3.6168, Perplexity: 37.2196
Epoch [0/5], Step [160/340], Loss: 3.5022, Perplexity: 33.1887
Epoch [0/5], Step [170/340], Loss: 3.5302, Perplexity: 34.1312
Epoch [0/5], Step [180/340], Loss: 3.4235, Perplexity: 30.6770
Epoch [0/5], Step [190/340], Loss: 3.4415, Perplexity: 31.2336
Epoch [0/5], Step [200/340], Loss: 3.5084, Perplexity: 33.3956
Epoch [0/5], Step [210/340], Loss: 3.3190, Perplexity: 27.6323
Epoch [0/5], Step [220/340], Loss: 3.3822, Perplexity: 29.4342
Epoch [0/5], Step [230/340], Loss: 3.4885, Perplexity: 32.7354
Epoch [0/5], Step [240/340], Loss: 3.3405, Perplexity: 28.2325
Epoch [0/5], Step [250/340], Loss: 3.2341, Perplexity: 25.3827
Epoch [0/5], Step [260/340], Loss: 3.3789, Perplexity: 29.3378
Epoch [0/5], Step [270/340], Loss: 3.2480, Perplexity: 25.7383
Epoch [0/5], Step [280/340], Loss: 3.3139, Perplexity: 27.4914
Epoch [0/5], Step [290/340], Loss: 3.2145, Perplexity: 24.8905
Epoch [0/5], Step [300/340], Loss: 3.2733, Perplexity: 26.3977
Epoch [0/5], Step [310/340], Loss: 3.2626, Perplexity: 26.1186
Epoch [0/5], Step [320/340], Loss: 3.2053, Perplexity: 24.6624
Epoch [0/5], Step [330/340], Loss: 3.2783, Perplexity: 26.5298
Epoch [1/5], Step [0/340], Loss: 2.9958, Perplexity: 20.0011
Epoch [1/5], Step [10/340], Loss: 3.2018, Perplexity: 24.5761
Epoch [1/5], Step [20/340], Loss: 3.1056, Perplexity: 22.3237
Epoch [1/5], Step [30/340], Loss: 3.1320, Perplexity: 22.9198
Epoch [1/5], Step [40/340], Loss: 3.2604, Perplexity: 26.0590
Epoch [1/5], Step [50/340], Loss: 3.1089, Perplexity: 22.3969
Epoch [1/5], Step [60/340], Loss: 3.2214, Perplexity: 25.0643
Epoch [1/5], Step [70/340], Loss: 3.1225, Perplexity: 22.7040
Epoch [1/5], Step [80/340], Loss: 2.9188, Perplexity: 18.5184
Epoch [1/5], Step [90/340], Loss: 3.1012, Perplexity: 22.2243
Epoch [1/5], Step [100/340], Loss: 2.8871, Perplexity: 17.9418
Epoch [1/5], Step [110/340], Loss: 3.1284, Perplexity: 22.8370
Epoch [1/5], Step [120/340], Loss: 3.0570, Perplexity: 21.2645
Epoch [1/5], Step [130/340], Loss: 2.9775, Perplexity: 19.6378
Epoch [1/5], Step [140/340], Loss: 3.0594, Perplexity: 21.3146
Epoch [1/5], Step [150/340], Loss: 2.9621, Perplexity: 19.3376
Epoch [1/5], Step [160/340], Loss: 3.0255, Perplexity: 20.6046
Epoch [1/5], Step [170/340], Loss: 2.9848, Perplexity: 19.7831
Epoch [1/5], Step [180/340], Loss: 2.9997, Perplexity: 20.0802
Epoch [1/5], Step [190/340], Loss: 3.1249, Perplexity: 22.7571
Epoch [1/5], Step [200/340], Loss: 3.0485, Perplexity: 21.0833
Epoch [1/5], Step [210/340], Loss: 2.8888, Perplexity: 17.9723
Epoch [1/5], Step [220/340], Loss: 2.9638, Perplexity: 19.3722
Epoch [1/5], Step [230/340], Loss: 2.8578, Perplexity: 17.4235
Epoch [1/5], Step [240/340], Loss: 3.0366, Perplexity: 20.8338
Epoch [1/5], Step [250/340], Loss: 3.0250, Perplexity: 20.5948
Epoch [1/5], Step [260/340], Loss: 2.9342, Perplexity: 18.8074
Epoch [1/5], Step [270/340], Loss: 2.8717, Perplexity: 17.6671
Epoch [1/5], Step [280/340], Loss: 3.1154, Perplexity: 22.5415
Epoch [1/5], Step [290/340], Loss: 2.9484, Perplexity: 19.0751
Epoch [1/5], Step [300/340], Loss: 3.0889, Perplexity: 21.9522
Epoch [1/5], Step [310/340], Loss: 2.8948, Perplexity: 18.0791
Epoch [1/5], Step [320/340], Loss: 2.8332, Perplexity: 17.0002
Epoch [1/5], Step [330/340], Loss: 2.9079, Perplexity: 18.3191
Epoch [2/5], Step [0/340], Loss: 2.8105, Perplexity: 16.6180
Epoch [2/5], Step [10/340], Loss: 2.7245, Perplexity: 15.2487
Epoch [2/5], Step [20/340], Loss: 2.7473, Perplexity: 15.5997
Epoch [2/5], Step [30/340], Loss: 2.7679, Perplexity: 15.9259
Epoch [2/5], Step [40/340], Loss: 2.9503, Perplexity: 19.1119
Epoch [2/5], Step [50/340], Loss: 2.7481, Perplexity: 15.6126
Epoch [2/5], Step [60/340], Loss: 2.8725, Perplexity: 17.6820
Epoch [2/5], Step [70/340], Loss: 2.7257, Perplexity: 15.2664
Epoch [2/5], Step [80/340], Loss: 2.7024, Perplexity: 14.9153
Epoch [2/5], Step [90/340], Loss: 2.7616, Perplexity: 15.8251
Epoch [2/5], Step [100/340], Loss: 2.7603, Perplexity: 15.8047
Epoch [2/5], Step [110/340], Loss: 2.7672, Perplexity: 15.9138
Epoch [2/5], Step [120/340], Loss: 2.8244, Perplexity: 16.8514
Epoch [2/5], Step [130/340], Loss: 2.7026, Perplexity: 14.9191
Epoch [2/5], Step [140/340], Loss: 2.6350, Perplexity: 13.9436
Epoch [2/5], Step [150/340], Loss: 2.7804, Perplexity: 16.1255
Epoch [2/5], Step [160/340], Loss: 2.8368, Perplexity: 17.0619
Epoch [2/5], Step [170/340], Loss: 2.7102, Perplexity: 15.0316
Epoch [2/5], Step [180/340], Loss: 2.9781, Perplexity: 19.6507
Epoch [2/5], Step [190/340], Loss: 2.8195, Perplexity: 16.7680
Epoch [2/5], Step [200/340], Loss: 2.6818, Perplexity: 14.6108
Epoch [2/5], Step [210/340], Loss: 2.7231, Perplexity: 15.2276
Epoch [2/5], Step [220/340], Loss: 2.7722, Perplexity: 15.9930
Epoch [2/5], Step [230/340], Loss: 2.5871, Perplexity: 13.2910
Epoch [2/5], Step [240/340], Loss: 2.6554, Perplexity: 14.2306
Epoch [2/5], Step [250/340], Loss: 2.7603, Perplexity: 15.8044
Epoch [2/5], Step [260/340], Loss: 2.7156, Perplexity: 15.1130
Epoch [2/5], Step [270/340], Loss: 2.8228, Perplexity: 16.8247
Epoch [2/5], Step [280/340], Loss: 2.8055, Perplexity: 16.5354
Epoch [2/5], Step [290/340], Loss: 2.7309, Perplexity: 15.3464
Epoch [2/5], Step [300/340], Loss: 2.6835, Perplexity: 14.6365
Epoch [2/5], Step [310/340], Loss: 2.7414, Perplexity: 15.5081
Epoch [2/5], Step [320/340], Loss: 2.8063, Perplexity: 16.5490
Epoch [2/5], Step [330/340], Loss: 2.8818, Perplexity: 17.8470
Epoch [3/5], Step [0/340], Loss: 2.6130, Perplexity: 13.6401
Epoch [3/5], Step [10/340], Loss: 2.6261, Perplexity: 13.8191
Epoch [3/5], Step [20/340], Loss: 2.6151, Perplexity: 13.6682
Epoch [3/5], Step [30/340], Loss: 2.6963, Perplexity: 14.8243
Epoch [3/5], Step [40/340], Loss: 2.6456, Perplexity: 14.0920
Epoch [3/5], Step [50/340], Loss: 2.6551, Perplexity: 14.2265
Epoch [3/5], Step [60/340], Loss: 2.5384, Perplexity: 12.6594
Epoch [3/5], Step [70/340], Loss: 2.5820, Perplexity: 13.2229
Epoch [3/5], Step [80/340], Loss: 2.6670, Perplexity: 14.3968
Epoch [3/5], Step [90/340], Loss: 2.6530, Perplexity: 14.1968
Epoch [3/5], Step [100/340], Loss: 2.5557, Perplexity: 12.8801
Epoch [3/5], Step [110/340], Loss: 2.6394, Perplexity: 14.0050
Epoch [3/5], Step [120/340], Loss: 2.6386, Perplexity: 13.9937
Epoch [3/5], Step [130/340], Loss: 2.6124, Perplexity: 13.6320
Epoch [3/5], Step [140/340], Loss: 2.5774, Perplexity: 13.1624
Epoch [3/5], Step [150/340], Loss: 2.6354, Perplexity: 13.9487
Epoch [3/5], Step [160/340], Loss: 2.6440, Perplexity: 14.0690
Epoch [3/5], Step [170/340], Loss: 2.6341, Perplexity: 13.9307
Epoch [3/5], Step [180/340], Loss: 2.6281, Perplexity: 13.8472
Epoch [3/5], Step [190/340], Loss: 2.7291, Perplexity: 15.3188
Epoch [3/5], Step [200/340], Loss: 2.6743, Perplexity: 14.5026
Epoch [3/5], Step [210/340], Loss: 2.5166, Perplexity: 12.3869
Epoch [3/5], Step [220/340], Loss: 2.6612, Perplexity: 14.3134
Epoch [3/5], Step [230/340], Loss: 2.7392, Perplexity: 15.4742
Epoch [3/5], Step [240/340], Loss: 2.6190, Perplexity: 13.7226
Epoch [3/5], Step [250/340], Loss: 2.6244, Perplexity: 13.7969
Epoch [3/5], Step [260/340], Loss: 2.6572, Perplexity: 14.2562
Epoch [3/5], Step [270/340], Loss: 2.6844, Perplexity: 14.6498
Epoch [3/5], Step [280/340], Loss: 2.6598, Perplexity: 14.2941
Epoch [3/5], Step [290/340], Loss: 2.6175, Perplexity: 13.7011
Epoch [3/5], Step [300/340], Loss: 2.5844, Perplexity: 13.2549
Epoch [3/5], Step [310/340], Loss: 2.5308, Perplexity: 12.5636
Epoch [3/5], Step [320/340], Loss: 2.5926, Perplexity: 13.3647
Epoch [3/5], Step [330/340], Loss: 2.5197, Perplexity: 12.4248
Epoch [4/5], Step [0/340], Loss: 2.4230, Perplexity: 11.2794
Epoch [4/5], Step [10/340], Loss: 2.3759, Perplexity: 10.7611
Epoch [4/5], Step [20/340], Loss: 2.5750, Perplexity: 13.1317
Epoch [4/5], Step [30/340], Loss: 2.5543, Perplexity: 12.8621
Epoch [4/5], Step [40/340], Loss: 2.4232, Perplexity: 11.2821
Epoch [4/5], Step [50/340], Loss: 2.4770, Perplexity: 11.9049
Epoch [4/5], Step [60/340], Loss: 2.4300, Perplexity: 11.3592
Epoch [4/5], Step [70/340], Loss: 2.3836, Perplexity: 10.8442
Epoch [4/5], Step [80/340], Loss: 2.4142, Perplexity: 11.1810
Epoch [4/5], Step [90/340], Loss: 2.4310, Perplexity: 11.3705
Epoch [4/5], Step [100/340], Loss: 2.4742, Perplexity: 11.8724
Epoch [4/5], Step [110/340], Loss: 2.3228, Perplexity: 10.2045
Epoch [4/5], Step [120/340], Loss: 2.4938, Perplexity: 12.1074
Epoch [4/5], Step [130/340], Loss: 2.4030, Perplexity: 11.0560
Epoch [4/5], Step [140/340], Loss: 2.4346, Perplexity: 11.4116
Epoch [4/5], Step [150/340], Loss: 2.4419, Perplexity: 11.4953
Epoch [4/5], Step [160/340], Loss: 2.5298, Perplexity: 12.5513
Epoch [4/5], Step [170/340], Loss: 2.5400, Perplexity: 12.6798
Epoch [4/5], Step [180/340], Loss: 2.5550, Perplexity: 12.8718
Epoch [4/5], Step [190/340], Loss: 2.5822, Perplexity: 13.2260
Epoch [4/5], Step [200/340], Loss: 2.3420, Perplexity: 10.4021
Epoch [4/5], Step [210/340], Loss: 2.5916, Perplexity: 13.3507
Epoch [4/5], Step [220/340], Loss: 2.4810, Perplexity: 11.9535
Epoch [4/5], Step [230/340], Loss: 2.4904, Perplexity: 12.0663
Epoch [4/5], Step [240/340], Loss: 2.5409, Perplexity: 12.6913
Epoch [4/5], Step [250/340], Loss: 2.4570, Perplexity: 11.6697
Epoch [4/5], Step [260/340], Loss: 2.5998, Perplexity: 13.4608
Epoch [4/5], Step [270/340], Loss: 2.4997, Perplexity: 12.1785
Epoch [4/5], Step [280/340], Loss: 2.5087, Perplexity: 12.2886
Epoch [4/5], Step [290/340], Loss: 2.4777, Perplexity: 11.9135
Epoch [4/5], Step [300/340], Loss: 2.5293, Perplexity: 12.5452
Epoch [4/5], Step [310/340], Loss: 2.5497, Perplexity: 12.8028
Epoch [4/5], Step [320/340], Loss: 2.5001, Perplexity: 12.1841
Epoch [4/5], Step [330/340], Loss: 2.4916, Perplexity: 12.0809
